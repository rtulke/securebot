# إعداد بوت تيليجرام لـ SecureBot

سيرشدك هذا الدليل خلال عملية إنشاء بوت تيليجرام وتكوينه للاستخدام مع SecureBot.

## إنشاء بوت باستخدام BotFather

1. **افتح تيليجرام** وابحث عن `@BotFather` أو انقر على هذا الرابط: [BotFather](https://t.me/botfather)

2. **ابدأ محادثة** مع BotFather بالنقر على "ابدأ" أو إرسال `/start`

3. **أنشئ بوت جديد** بإرسال الأمر:
   ```
   /newbot
   ```

4. **اختر اسمًا** لبوت الخاص بك عند الطلب. هذا هو الاسم الذي سيظهر في المحادثات (مثال، "مراقب أمان SecureBot")

5. **اختر اسم مستخدم** لبوت الخاص بك عند الطلب. يجب أن ينتهي بكلمة "bot" وأن يكون فريدًا (مثال، "your_security_bot" أو "your_company_securebot")

6. **احفظ رمز API الخاص بك!** سيوفر لك BotFather رمز API يشبه:
   ```
   123456789:ABCDefGhIJKlmNoPQRsTUVwxyZ
   ```
   هذا الرمز ضروري لتكوين SecureBot ويجب الحفاظ عليه آمنًا.

## الحصول على معرّف الدردشة الخاص بك

### الطريقة 1: استخدام @userinfobot

1. ابحث عن `@userinfobot` على تيليجرام وابدأ محادثة
2. سيرد البوت تلقائيًا بمعلومات حسابك، بما في ذلك معرّف الدردشة

### الطريقة 2: استخدام @RawDataBot

1. ابحث عن `@RawDataBot` على تيليجرام وابدأ محادثة
2. سيرسل لك البوت رسالة JSON تحتوي على معلوماتك
3. ابحث عن حقل `"id"` في قسم "from" للعثور على معرّف الدردشة الخاص بك

### الطريقة 3: للدردشات الجماعية

إذا كنت ترغب في تلقي إشعارات في مجموعة:

1. أضف البوت الجديد الخاص بك إلى المجموعة
2. أرسل رسالة في المجموعة
3. قم بزيارة عنوان URL التالي في متصفحك (استبدله برمز البوت الخاص بك):
   ```
   https://api.telegram.org/bot<رمز_البوت_الخاص_بك>/getUpdates
   ```
4. ابحث عن `"chat":{"id":-123456789,` في الاستجابة. لاحظ أن معرّفات دردشة المجموعة عادة ما تكون أرقامًا سالبة

## تكوين أذونات البوت

لتحسين الأمان، يجب عليك تكوين هذه الإعدادات مع BotFather:

1. استخدم الأمر `/mybots` في BotFather
2. حدد البوت الذي أنشأته حديثًا
3. انقر على "Bot Settings" > "Group Privacy"
4. حدد "Disable" إذا كان البوت الخاص بك يحتاج إلى رؤية جميع الرسائل في مجموعة، أو حافظ على "Enable" (موصى به) إذا كان يحتاج فقط إلى رؤية الأوامر الموجهة إليه
5. يمكنك أيضًا تعيين وصف وقسم "حول" للبوت الخاص بك من قائمة إعدادات البوت

## إضافة أذونات المسؤول/المشاهد في SecureBot

1. حدد معرّفات مستخدمي تيليجرام للمسؤولين والمشاهدين
2. قم بتحرير ملف تكوين SecureBot (إما مباشرة أو عبر Ansible):

```toml
[telegram]
bot_token = "رمز_البوت_الخاص_بك"  # الرمز من BotFather
chat_id = "معرّف_الدردشة_الخاص_بك"   # معرّف المستخدم أو معرّف دردشة المجموعة
admin_users = [123456789]        # معرّفات المستخدمين المسؤولين
viewer_users = [987654321]       # معرّفات المستخدمين المشاهدين
```

## اختبار تكوين البوت الخاص بك

1. بعد تكوين SecureBot برمز البوت ومعرّف الدردشة، ابدأ خدمة SecureBot:
   ```bash
   sudo systemctl start securebot
   ```

2. افتح عميل تيليجرام الخاص بك وأرسل الرسالة التالية إلى البوت الخاص بك:
   ```
   /start
   ```

3. يجب أن يرد البوت الخاص بك برسالة ترحيب إذا كان كل شيء مكونًا بشكل صحيح

4. اختبر الأوامر الأساسية:
   ```
   /help
   /status
   ```

## استكشاف الأخطاء وإصلاحها

إذا كان البوت الخاص بك لا يستجيب:

1. تحقق من سجلات SecureBot:
   ```bash
   sudo journalctl -u securebot
   ```

2. تحقق من صحة رمز البوت في ملف التكوين
   
3. تأكد من تشغيل خدمة SecureBot:
   ```bash
   sudo systemctl status securebot
   ```

4. تحقق من أن معرّف مستخدم تيليجرام الخاص بك مضبوط بشكل صحيح كمسؤول أو مشاهد في التكوين

5. تأكد من أن البوت الخاص بك لديه أذونات كافية إذا تم استخدامه في مجموعة

## اعتبارات الأمان

- لا تشارك رمز البوت الخاص بك علنًا أبدًا
- قم بتدوير رمز البوت الخاص بك بانتظام إذا كنت تشك في أنه قد تم اختراقه
- أضف فقط المستخدمين الموثوق بهم إلى قائمة admin_users
- فكر في تقييد البوت لمجموعة خاصة بدلاً من استخدامه في القنوات العامة

## الخطوات التالية

بعد إعداد بوت تيليجرام بنجاح، تابع بتكوين إعدادات المراقبة في ملف تكوين SecureBot لبدء تلقي إشعارات الأمان.
